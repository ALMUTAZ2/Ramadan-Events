<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุงุฒูุฑ ุฑูุถุงู 1446</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        
        * {
            font-family: 'Cairo', sans-serif;
        }

        @keyframes floatMoon {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .floating-moon {
            animation: floatMoon 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .star {
            position: absolute;
            color: #FCD34D;
            animation: twinkle 2s ease-in-out infinite;
        }

        .option-correct {
            background-color: rgba(34, 197, 94, 0.2) !important;
            border-color: rgb(34, 197, 94) !important;
        }

        .option-wrong {
            background-color: rgba(239, 68, 68, 0.2) !important;
            border-color: rgb(239, 68, 68) !important;
        }

        .option-disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        @keyframes scaleNumber {
            0% { transform: scale(1); opacity: 0; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }

        .countdown-number {
            animation: scaleNumber 1s ease-out;
        }

        .countdown-text {
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-b from-blue-900 to-indigo-950 min-h-screen">
    <!-- ุดุฑูุท ุงูุชุงุฑูุฎ -->
    <div class="bg-white/5 backdrop-blur-sm border-b border-white/10 p-3 text-white text-center">
        <div class="max-w-3xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span id="day-name" class="text-blue-400"></span>
            </div>
            <div class="flex items-center gap-2">
                <span id="current-date" class="text-green-400"></span>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุฎุงุฑุฌ ููุช ุงููุณุงุจูุฉ -->
    <div id="out-of-time-screen" class="hidden min-h-screen text-white flex items-center justify-center p-6">
        <div class="max-w-md w-full">
            <div class="bg-white/10 backdrop-blur-lg border-2 border-yellow-400/20 rounded-3xl p-8 text-center">
                <i data-lucide="clock" class="w-16 h-16 mx-auto text-yellow-400 mb-4"></i>
                <h2 class="text-2xl font-bold text-yellow-400 mb-4">ุงููุณุงุจูุฉ ุบูุฑ ูุชุงุญุฉ ุญุงููุงู</h2>
                <p class="text-gray-300 mb-4">ุงููุณุงุจูุฉ ูุชุงุญุฉ ููููุงู ูู ุงูุณุงุนุฉ 7 ูุณุงุกู ุญุชู 8 ูุณุงุกู</p>
                <div id="time-message" class="text-green-400 text-lg mb-8"></div>
                <a href="leaderboard.html" class="inline-block bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white px-8 py-3 rounded-xl">
                    ุนุฑุถ ูุชุงุฆุฌ ุงููุชุตุฏุฑูู
                </a>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงููุดุงุฑูุฉ ุงูุณุงุจูุฉ -->
    <div id="already-participated-screen" class="hidden min-h-screen text-white flex items-center justify-center p-6">
        <div class="max-w-md w-full">
            <div class="bg-white/10 backdrop-blur-lg border-2 border-red-400/20 rounded-3xl p-8 text-center">
                <i data-lucide="alert-circle" class="w-16 h-16 mx-auto text-red-400 mb-4"></i>
                <h2 class="text-2xl font-bold text-red-400 mb-4">ููุฏ ุดุงุฑูุช ูุณุจูุงู</h2>
                <p class="text-gray-300 mb-6">ููููู ุงููุดุงุฑูุฉ ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ุงูููู</p>
                <a href="leaderboard.html" class="inline-block bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white px-8 py-3 rounded-xl">
                    ุนุฑุถ ูุชุงุฆุฌ ุงููุชุตุฏุฑูู
                </a>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุฌุงุฑู ุงูุชุญููู -->
    <div id="loading-screen" class="hidden min-h-screen text-white flex items-center justify-center p-6">
        <div class="max-w-md w-full">
            <div class="bg-white/10 backdrop-blur-lg border-2 border-blue-400/20 rounded-3xl p-8 text-center">
                <div class="animate-spin w-16 h-16 mx-auto border-4 border-blue-400 border-t-transparent rounded-full mb-4"></div>
                <h2 class="text-2xl font-bold text-blue-400 mb-4">ุฌุงุฑู ุงูุชุญููู</h2>
                <p class="text-gray-300 mb-6">ูุฑุฌู ุงูุงูุชุธุงุฑ...</p>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
    <div id="start-screen" class="hidden min-h-[calc(100vh-64px)] text-white flex items-center justify-center p-6">
        <div class="max-w-md w-full">
            <div class="bg-white/10 backdrop-blur-lg border-2 border-green-400/20 rounded-3xl p-8">
                <div class="text-center space-y-6">
                    <div class="relative h-32">
                        <div class="floating-moon">
                            <i data-lucide="moon" class="w-20 h-20 mx-auto text-yellow-400"></i>
                        </div>
                        <div class="absolute bottom-0 w-full">
                            <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% - 20px);"></i>
                            <i data-lucide="star" class="star w-4 h-4" style="left: 50%;"></i>
                            <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% + 20px);"></i>
                        </div>
                    </div>
                    <h1 class="text-3xl font-bold text-yellow-400">ููุงุฒูุฑ ุฑูุถุงู</h1>
                    <div class="space-y-4">
                        <label class="text-lg block text-center mb-2">
                            ุฃุฏุฎู ุงุณูู ูููุดุงุฑูุฉ ูู ุงููุณุงุจูุฉ
                        </label>
                        <input
                            type="text"
                            id="player-name"
                            placeholder="ุงูุงุณู ุงููุฑูู"
                            class="w-full bg-white/5 border-2 border-green-400/20 text-center text-lg py-6 rounded-xl text-white"
                        >
                        <input
                            type="email"
                            id="player-email"
                            placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ุงุฎุชูุงุฑู)"
                            class="w-full bg-white/5 border-2 border-green-400/20 text-center text-lg py-6 rounded-xl text-white"
                        >
                    </div>
                    <button
                        id="start-button"
                        class="w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white py-6 rounded-xl text-lg flex items-center justify-center gap-2"
                        disabled
                    >
                        <i data-lucide="sparkles" class="w-5 h-5"></i>
                        ุจุฏุก ุงููุณุงุจูุฉ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุนุฏ ุงูุชูุงุฒูู -->
    <div id="countdown-screen" class="fixed inset-0 bg-blue-900/95 backdrop-blur-sm hidden z-50 flex items-center justify-center">
        <div class="text-center">
            <div id="countdown-number" class="text-8xl font-bold text-yellow-400 mb-4 countdown-number"></div>
            <div id="countdown-text" class="text-2xl text-white countdown-text"></div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุฃุณุฆูุฉ -->
    <div id="quiz-screen" class="min-h-screen text-white p-6 hidden">
        <div class="max-w-3xl mx-auto">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-yellow-400 mb-2">ููุงุฒูุฑ ุฑูุถุงู</h1>
                <p id="player-welcome" class="text-lg text-green-400"></p>
            </div>
            <div class="bg-white/10 backdrop-blur-lg border-2 border-green-400/20 rounded-2xl p-6">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center gap-2">
                        <i data-lucide="clock" class="w-5 h-5"></i>
                        <span id="timer" class="text-xl font-bold">10</span>
                    </div>
                    <div id="question-counter" class="text-lg"></div>
                </div>
                <div class="relative h-2 bg-gray-700/50 rounded-full overflow-hidden mb-6">
                    <div id="timer-bar" class="absolute top-0 left-0 h-full bg-green-400 transition-all duration-1000"></div>
                </div>
                <h3 id="question-text" class="text-xl font-semibold mb-6 pr-4 border-r-4 border-green-400"></h3>
                <div id="options-container" class="space-y-4"></div>
            </div>
        </div>
    </div>

<!-- ุดุงุดุฉ ุงูุดูุฑ -->
<div id="thank-you-screen" class="min-h-screen text-white p-6 hidden">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white/10 backdrop-blur-lg border-2 border-green-400/20 rounded-2xl p-8 text-center">
            <div class="relative h-32 mb-6">
                <div class="floating-moon">
                    <i data-lucide="moon" class="w-20 h-20 mx-auto text-yellow-400"></i>
                </div>
                <div class="absolute bottom-0 w-full">
                    <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% - 20px);"></i>
                    <i data-lucide="star" class="star w-4 h-4" style="left: 50%;"></i>
                    <i data-lucide="star" class="star w-4 h-4" style="left: calc(50% + 20px);"></i>
                </div>
            </div>
            <h3 class="text-2xl font-bold text-yellow-400 mb-6">ุดูุฑุงู ููุดุงุฑูุชู ูุนูุง!</h3>
            <div class="prose prose-invert max-w-none space-y-4">
                <p class="text-gray-300">ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ</p>
                <p class="text-gray-300">ูุน ุงูุชุฑุงุจ ุฎุชุงู ุดูุฑ ุฑูุถุงู ุงููุจุงุฑูุ ุงุชูุฏู ุจุฃุณูู ุขูุงุช ุงูุดูุฑ ูุงูุชูุฏูุฑ ุนูู ูุดุงุฑูุชูู ุงููููุฒุฉ ูู "ููุงุฒูุฑ ุฑูุถุงู".</p>
          <p class="text-gray-300">ููุฏ ุฃุถูุชู ุจุญูุงุณูู ูุชูุงุนููู ุฑูุญุงู ุฎุงุตุฉ ุฌุนูุช ูู ูุฐู ุงูุชุฌุฑุจุฉ ูุญุธุงุช ูุง ุชููุณู ูููุฆุฉ ุจุงููุนุฑูุฉ ูุงูุจูุฌุฉ.</p>

      <p class="text-gray-300">ุฃุณุฃู ุงููู ุฃู ูุชูุจู ููุง ููููู ุตุงูุญ ุงูุฃุนูุงูุ ูุฃู ูุนูุฏ ุนูููุง ูุนูููู ูุฐู ุงูุฃูุงู ุงููุจุงุฑูุฉ ุจุงูุฎูุฑ ููุงูููููููู ูุงูุจุฑูุงุช.
</p>

<h3 class="text-2xl font-bold text-yellow-400 mb-6">ูู ุนุงู ูุฃูุชู ุจุฎูุฑ</h3>
<h3 class="text-2xl font-bold text-yellow-400 mb-6"> ูุนูุฏูู ูุจุงุฑู ููุฏูุงู</h3>


                <h3 class="text-2xl font-bold text-yellow-400 mb-6"> ุงููุนูุชุฒ ุฃุจูู ุทุงููุจ </h3>
                
                
            </div>
            <button id="show-results-button" class="mt-8 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-4 rounded-xl text-lg">
                ุนุฑุถ ุงููุชุงุฆุฌ
            </button>
        </div>
    </div>
</div>

    
    <!-- ุดุงุดุฉ ุงููุชุงุฆุฌ -->
    <div id="results-screen" class="min-h-screen text-white p-6 hidden">
        <div class="max-w-2xl mx-auto">
            <div class="bg-white/10 backdrop-blur-lg border-2 border-yellow-400/30 rounded-2xl p-8">
                <i data-lucide="trophy" class="w-16 h-16 mx-auto text-yellow-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-yellow-400 mb-4 text-center">ุงููุชูุฌุฉ ุงูููุงุฆูุฉ</h3>
                <p id="final-name" class="text-xl mb-4 text-center"></p>
                <p id="final-score" class="text-xl mb-6 text-center"></p>
                <div id="answers-review" class="space-y-4 mt-8"></div>
                <div class="flex gap-4 mt-6">
                    <button onclick="location.reload()" class="flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white py-4 rounded-xl text-lg">
                        ุญุงูู ูุฑุฉ ุฃุฎุฑู
                    </button>
                    <button onclick="window.location.href='leaderboard.html'" class="flex-1 bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white py-4 rounded-xl text-lg">
                        ูุงุฆูุฉ ุงููุชุตุฏุฑูู
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // ุชููุฆุฉ Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC5RYK1lGaJaMQJmOH85cqNgv6m7rbLS_A",
            authDomain: "ramadanmotaz-5570f.firebaseapp.com",
            projectId: "ramadanmotaz-5570f",
            storageBucket: "ramadanmotaz-5570f.appspot.com",
            messagingSenderId: "595667154066",
            appId: "1:595667154066:web:80ba616566ec55a5efe24b",
            measurementId: "G-WLVRQVRGHT"
        };

        let db;
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            db = firebase.firestore();
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.error('Error initializing Firebase:', error);
        }
       
        // ุจูู ุงูุฃุณุฆูุฉ
        const ramadanQuestions = {
            6: [ // ุงูููู 15 ูู ุฑูุถุงู
                {
                    question: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ูุฒูุช ูู ูููุฉ ุงููุตู ูู ุฑูุถุงูุ",
                    options: ["ุณูุฑุฉ ุงูุฏุฎุงู", "ุณูุฑุฉ ุงููุฏุฑ", "ุณูุฑุฉ ุงูุจูุฑุฉ", "ุณูุฑุฉ ูุณ"],
                    correct: 0
                },
                {
                    question: "ูู ุนุฏุฏ ุงูุฑูุนุงุช ูู ุตูุงุฉ ุงูุชุฑุงููุญ ุงูุชู ูุงู ูุตูููุง ุงููุจู ๏ทบุ",
                    options: ["8 ุฑูุนุงุช", "11 ุฑูุนุฉ", "20 ุฑูุนุฉ", "23 ุฑูุนุฉ"],
                    correct: 1
                },
                {
                    question: "ูุง ูู ุฏุนุงุก ุงููุตู ูู ุฑูุถุงู ุงููุฃุซูุฑุ",
                    options: [
                        "ุงูููู ุงุบูุฑ ูู ุฐููุจู",
                        "ุงูููู ุฅูู ุนูู ุชุญุจ ุงูุนูู ูุงุนู ุนูู",
                        "ุงูููู ุจูุบูุง ุฑูุถุงู",
                        "ุงูููู ุชูุจู ููุง ุตูุงููุง"
                    ],
                    correct: 1
                },
                {
                    question: "ูุง ูู ุงูุนุจุงุฏุฉ ุงูุชู ุชูุณุชุญุจ ูู ุงููุตู ุงูุซุงูู ูู ุฑูุถุงูุ",
                    options: [
                        "ุงูุงุนุชูุงู",
                        "ุตูุงู ุงูููุงูู",
                        "ุตูุงุฉ ุงูุถุญู",
                        "ููุงู ุงูููู"
                    ],
                    correct: 0
                },
                {
                    question: "ูู ูุฑุฉ ุฎุชู ุงููุจู ๏ทบ ุงููุฑุขู ูู ุฑูุถุงู ูุน ุฌุจุฑูู ุนููู ุงูุณูุงูุ",
                    options: ["ูุฑุฉ ูุงุญุฏุฉ", "ูุฑุชูู", "ุซูุงุซ ูุฑุงุช", "ุฃุฑุจุน ูุฑุงุช"],
                    correct: 1
                }
            ],
            16: [ // ุงูููู 16 ูู ุฑูุถุงู
                {
                    question: "ูุชู ูุงูุช ุบุฒูุฉ ุจุฏุฑ ุงููุจุฑูุ",
                    options: ["17 ุฑูุถุงู ุงูุณูุฉ ุงูุซุงููุฉ ูููุฌุฑุฉ", "15 ุฑูุถุงู ุงูุณูุฉ ุงูุซุงูุซุฉ ูููุฌุฑุฉ", "20 ุฑูุถุงู ุงูุณูุฉ ุงูุฃููู ูููุฌุฑุฉ", "10 ุฑูุถุงู ุงูุณูุฉ ุงูุฑุงุจุนุฉ ูููุฌุฑุฉ"],
                    correct: 0
                },
                {
                    question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ูุงู ุฃูู ูุคุฐู ูู ุงูุฅุณูุงูุ",
                    options: ["ุจูุงู ุจู ุฑุจุงุญ", "ุนุจุฏุงููู ุจู ูุณุนูุฏ", "ุณุนุฏ ุจู ุฃุจู ููุงุต", "ุนูุฑ ุจู ุงูุฎุทุงุจ"],
                    correct: 0
                },
                {
                    question: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ุชุคุฏู ุจุนุฏ ุตูุงุฉ ุงูุนุดุงุก ูู ุฑูุถุงูุ",
                    options: ["ููุงู ุงูููู", "ุงูุชูุฌุฏ", "ุงูุชุฑุงููุญ", "ุงููุชุฑ"],
                    correct: 2
                },
                {
                    question: "ูุง ูู ุฃูู ุบุฒูุฉ ูุงุฏูุง ุงููุจู ๏ทบ ุจููุณูุ",
                    options: ["ุบุฒูุฉ ุงูุฎูุฏู", "ุบุฒูุฉ ุจุฏุฑ", "ุบุฒูุฉ ุฃุญุฏ", "ุบุฒูุฉ ุชุจูู"],
                    correct: 1
                },
                {
                    question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ุงุดุชูุฑ ุจููุจ ยซุงููุงุฑููยปุ",
                    options: ["ุนูู ุจู ุฃุจู ุทุงูุจ", "ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนุซูุงู ุจู ุนูุงู", "ุฃุจู ุจูุฑ ุงูุตุฏูู"],
                    correct: 1
                }
            ],
            17: [ // ุงูููู 17 ูู ุฑูุถุงู
                {
                    question: "ูุง ูู ุงูุดูุฑ ุงูุฐู ูุฒู ููู ุงููุฑุขู ุงููุฑููุ",
                    options: ["ุดุนุจุงู", "ุฑุฌุจ", "ุฑูุถุงู", "ุฐู ุงููุนุฏุฉ"],
                    correct: 2
                },
                {
                    question: "ูุง ูู ุงููููุฉ ุงูุชู ููุฑุฌู ุฃู ุชููู ูููุฉ ุงููุฏุฑุ",
                    options: ["ููุชุตู ุฑูุถุงู", "ุฃูู ูููุฉ ูู ุฑูุถุงู", "ุงูููุงูู ุงููุชุฑูุฉ ูู ุงูุนุดุฑ ุงูุฃูุงุฎุฑ", "ูููุฉ 15 ุฑูุถุงู"],
                    correct: 2
                },
                {
                    question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ุฃูุฑู ุงููุจู ๏ทบ ุจุงูุขุฐุงู ูู ุฑูุถุงูุ",
                    options: ["ุจูุงู ุจู ุฑุจุงุญ", "ุนุจุฏุงููู ุจู ุฃู ููุชูู", "ุฃุจู ูุฑูุฑุฉ", "ุนุจุฏุงููู ุจู ูุณุนูุฏ"],
                    correct: 0
                },
                {
                    question: "ูู ูุฑุฉ ุฐูุฑ ุงุณู ุฑูุถุงู ูู ุงููุฑุขู ุงููุฑููุ",
                    options: ["ูุฑุฉ ูุงุญุฏุฉ", "ูุฑุชูู", "ุซูุงุซ ูุฑุงุช", "ุฃุฑุจุน ูุฑุงุช"],
                    correct: 0
                },
                {
                    question: "ูุชู ูุงูุช ุงููุฌุฑุฉ ุงููุจููุฉุ",
                    options: ["ุงูุณูุฉ ุงูุนุงุดุฑุฉ ููุจุนุซุฉ", "ุงูุณูุฉ ุงูุซุงููุฉ ููุจุนุซุฉ", "ุงูุณูุฉ ุงูุซุงูุซุฉ ุนุดุฑุฉ ููุจุนุซุฉ", "ุงูุณูุฉ ุงูุฎุงูุณุฉ ููุจุนุซุฉ"],
                    correct: 2
                }
            ],
            18: [ // ุงูููู 18 ูู ุฑูุถุงู
                {
                    question: "ูู ูู ุฃูู ุงูุฎููุงุก ุงูุฑุงุดุฏููุ",
                    options: ["ุนุซูุงู ุจู ุนูุงู", "ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนูู ุจู ุฃุจู ุทุงูุจ", "ุฃุจู ุจูุฑ ุงูุตุฏูู"],
                    correct: 3
                },
                {
                    question: "ูู ุฃู ูุฌุฑุฉ ุจุฏุฃ ุงููุจู ูุญูุฏ ุตูู ุงููู ุนููู ูุณูู ุงูุงูุชูุงู ูู ููุฉ ุฅูู ุงููุฏููุฉุ",
                    options: ["ูุฌุฑุฉ 10 ูู", "ูุฌุฑุฉ 14 ูู", "ูุฌุฑุฉ 12 ูู", "ูุฌุฑุฉ 5 ูู"],
                    correct: 1
                },
                {
                    question: "ูุง ูู ุงููุชุงุจ ุงูููุฏุณ ูู ุงูุฅุณูุงูุ",
                    options: ["ุงูุฅูุฌูู", "ุงูุฒุจูุฑ", "ุงูุชูุฑุงุฉ", "ุงููุฑุขู"],
                    correct: 3
                },
                {
                    question: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชูุนุฑู ุจุณูุฑุฉ ุงูุฅุฎูุงุตุ",
                    options: ["ุณูุฑุฉ ุงูููู", "ุณูุฑุฉ ุงููุงุณ", "ุณูุฑุฉ ุงูุฅุฎูุงุต", "ุณูุฑุฉ ุงูููุซุฑ"],
                    correct: 2
                },
                {
                    question: "ูู ูู ุงููุจู ุงูุฐู ุงุจุชูุนู ุงูุญูุช ุซู ูุฌุง ุจุนุฏ ุฏุนุงุฆูุ",
                    options: ["ูููุณ", "ููุณู", "ููุญ", "ุนูุณู"],
                    correct: 0
                }
            ],
            19: [ // ุงูููู 19 ูู ุฑูุถุงู
                {
                    question: "ูุง ูู ุฃูู ูุนุฑูุฉ ูู ุงูุชุงุฑูุฎ ุงูุฅุณูุงููุ",
                    options: ["ุงูุฎูุฏู", "ุฃุญุฏ", "ุจุฏุฑ", "ุญููู"],
                    correct: 2
                },
                {
                    question: "ูู ูู ุงููุฏููุฉ ุงูุชู ุงุณุชุบุฑููุง ูุฒูู ุงููุฑุขู ุงููุฑููุ ",
                    options: ["ุนุดุฑ ุณููุงุช ", "ุงุญุฏู ุนุดุฑ ุณูู", "ูุงุญุฏ ูุนุดุฑูู ุณูู", "ุซูุงุซ ู ุนุดุฑูู ุณูู"],
                    correct: 3
                },
                {
                    question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ุฐูุฑ ุงุณูู ุตุฑูุญุงู ูู ุงููุฑุขู ุงููุฑููุ",
                    options: ["ุนูู ุจู ุฃุจู ุทุงูุจ", "ุฎุงูุฏ ุจู ุงููููุฏ", "ุฒูุฏ ุจู ุญุงุฑุซุฉ", "ุนุซูุงู ุจู ุนูุงู"],
                    correct: 2
                },
                {
                    question: "ูู ุนุฏุฏ ุงูุณูุฑ ุงููููุฉ ูู ุงููุฑุขู ุงููุฑููุ",
                     options: ["ุฅุญุฏู ุนุดุฑ ุณูุฑุฉ", "ุฎูุณ ู ุซูุงููู ุณูุฑุฉ", "ุนุดุฑ ุณูุฑ", "ุณุช ู ุซูุงููู ุณูุฑุฉ "],
                    correct: 3
                },
                {
                    question: "ูู ูู ุฃูู ุดููุฏุฉ ูู ุงูุฅุณูุงูุ ",
                    options: [" ูุณุชูุฑุฉ ุจูุช ุฃุจู ุณููุฉ", "ูุณูุจุฉ ุจูุช ูุนุจ", "ุณููุฉ ุจูุช ุฎูุงุท ", "ูุงุทูุฉ ุงูุฒูุฑุงุก"],
                    correct: 2
                }
            ],
            20: [ // ุงูููู 20 ูู ุฑูุถุงู 
    {
        question: " ูุง ุฃูู ูุฏูุฉ ููุฏูุช ูููุจู ุตูู ุงููู ุนููู ูุณูู ูู ุฏุงุฑ ุฃุจู ุฃููุจุ ",
        options: ["ูุตุนุฉ ูููุง ุฎุจุฒ ูุซุฑูุฏ ุจูุจู ูุณูู", "ูุตุนุฉ ูู ุงูุนุณู", "ูุตุนุฉ ูู ุงูุญุณุงุก", "ูุทุนุฉ ูู ุงููุญู ุงููุดูู"],
        correct: 0
    },
    {
        question: "ูู ุงูุฐู ุฃุฑุงุฏ ูุฏู ุงููุนุจุฉ ูู ุนุงู ุงููููุ",
        options: ["ุงูููุฑูุฏ", "ุฃุจู ุฌูู", "ุฃุจุฑูุฉ ุจู ุงูุตุจุงุญ", "ุฃุจุฑูุฉ ุงูุญุจุดู"],
        correct: 3
    },
    {
        question: "ูู ุงูุตุญุงุจูู ุงูุฌููู ุงูุฐู ูุงู ูู ูุฑุงุด ุงููุจูู ุตูู ุงููู ุนููู ูุณูู ูู ูููุฉ ุงููุฌุฑุฉุ",
        options: ["ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนูู ุจู ุฃุจู ุทุงูุจ", "ุฃุจู ุจูุฑ ุงูุตุฏูู", "ุนุจุฏ ุงููู ุจู ูุณุนูุฏ"],
        correct: 1
    },
    {
        question: "ูู ุงูุฐู ูุงู ูุฃุชู ุงููุจู ุตูู ุงููู ุนููู ูุณูู ูุฃุจู ุจูุฑ ุงูุตุฏูู ุจุงูุฃุฎุจุงุฑ ูููุง ูู ุบุงุฑ ุซูุฑุ",
        options: ["ุนูู ุจู ุฃุจู ุทุงูุจ", "ุนุจุฏ ุงูุฑุญูู ุจู ุนูู", "ุนุจุฏ ุงููู ุจู ุฃุจู ุจูุฑ", "ุฒูุฏ ุจู ุญุงุฑุซุฉ"],
        correct: 2
    },
    {
        question: "ูู ูู ุฃุตุญุงุจ ุงูุฃุนุฑุงูุ",
        options: ["ููู ุงุณุชูุช ุญุณูุงุชูู ูุณูุฆุงุชูู", "ุงูููุงุฆูุฉ ุงููุฑุงูุจูู ููุฌูุฉ ูุงููุงุฑ", "ุฃูุจูุงุก ูุดูุนูู ูููุงุณ", "ููุงุฑ ูู ุชุตููู ุงูุฑุณุงูุฉ"],
        correct: 0
    }
],
             
21: [ // ุงูููู 21 ูู ุฑูุถุงู
    {
        question: "ูู ุงูุตุญุงุจู ุงูุฐู ูุงู ุฃูู ูู ุฃุถุงุก ุงููุณุงุฌุฏ ุจุงูููุงุฏูู ูู ุดูุฑ ุฑูุถุงูุ",
        options: ["ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนุซูุงู ุจู ุนูุงู", "ุนูู ุจู ุฃุจู ุทุงูุจ", "ูุนุงููุฉ ุจู ุฃุจู ุณููุงู"],
        correct: 0
    },
    {
        question: "ูุง ุงุณู ุงูุบุฒูุฉ ุงูุชู ููุนุช ูู 20 ุฑูุถุงู ูู ุงูุณูุฉ ุงูุซุงููุฉ ูููุฌุฑุฉุ",
        options: ["ุบุฒูุฉ ุจุฏุฑ", "ุบุฒูุฉ ุฃุญุฏ", "ุบุฒูุฉ ุงูุฎูุฏู", "ุบุฒูุฉ ูุชุญ ููุฉ"],
        correct: 3
    },
    {
        question: "ูู ุฃูู ูู ุฌูุน ุงููุงุณ ุนูู ุตูุงุฉ ุงูุชุฑุงููุญ ูู ุงููุณุฌุฏ ุฎูู ุฅูุงู ูุงุญุฏุ",
        options: ["ุฃุจู ุจูุฑ ุงูุตุฏูู", "ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนุซูุงู ุจู ุนูุงู", "ุนูู ุจู ุฃุจู ุทุงูุจ"],
        correct: 1
    },
    {
        question: "ูู ุงูุตุญุงุจู ุงูุฐู ุฃุดุงุฑ ุนูู ุงููุจู ุตูู ุงููู ุนููู ูุณูู ุจุญูุฑ ุงูุฎูุฏู ูู ุบุฒูุฉ ุงูุฃุญุฒุงุจุ",
        options: [" ุณุนุฏ ุจู ุฃุจู ููุงุต", "ุฃุจู ุฐุฑ ุงูุบูุงุฑู", "ุณููุงู ุงููุงุฑุณู", "ุงูุฒุจูุฑ ุจู ุงูุนูุงู"],
        correct: 2
    },
    {
        question: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ุตููุงูุง ุงููุจู ุตูู ุงููู ุนููู ูุณูู ุจุงูุฃูุจูุงุก ูู ูููุฉ ุงูุฅุณุฑุงุก ูุงููุนุฑุงุฌุ",
        options: ["ุตูุงุฉ ุงููุบุฑุจ", "ุตูุงุฉ ุฑูุนุชูู ุฅูุงูุงู ุจุงูุฃูุจูุงุก", "ุตูุงุฉ ุงููุฌุฑ", "ุตูุงุฉ ุงูุนุดุงุก"],
        correct: 1
    }
],


            
            
            22: [ // ุงูููู 22 ูู ุฑูุถุงู
                {
                    question: "ูู ุนุฏุฏ ุณูุฑ ุงููุฑุขู ุงููุฑููุ",
                    options: ["112", "114", "116", "110"],
                    correct: 1
                },
                {
                    question: "ูุง ุงุณู ุงููุจู ุงูุฐู ุฃูุฒู ุงููู ุนููู ุงูุฅูุฌููุ",
                    options: ["ุนูุณู ุนููู ุงูุณูุงู", "ููุณู ุนููู ุงูุณูุงู", "ููุญ ุนููู ุงูุณูุงู", "ุฅุจุฑุงููู ุนููู ุงูุณูุงู"],
                    correct: 0
                },
                {
                    question: "ูู ุฃู ุดูุฑ ูุฒู ุงููุฑุขู ุนูู ุงููุจู ูุญูุฏ ุตูู ุงููู ุนููู ูุณููุ",
                    options: ["ุฑูุถุงู", "ุดูุงู", "ุฐู ุงููุนุฏุฉ", "ูุญุฑู"],
                    correct: 0
                },
                {
                    question: "ูู ูู ุงููุจู ุงูุฐู ุจูู ุงููุนุจุฉ ูุน ุงุจูู ุฅุณูุงุนูู ุนููููุง ุงูุณูุงูุ",
                    options: ["ุฅุจุฑุงููู ุนููู ุงูุณูุงู", "ููุญ ุนููู ุงูุณูุงู", "ููุณู ุนููู ุงูุณูุงู", "ุนูุณู ุนููู ุงูุณูุงู"],
                    correct: 0
                },
                {
                                        question: "ุฃู ูุฏููุฉ ูุฏููุฉ ุชูุน ูู ุจูุงุฏ ุงูุฑุงูุฏูู ูุชุดุชูุฑ ุจุชุงุฑูุฎูุงุ",
                    options: ["ุจุบุฏุงุฏ", "ุจุงุจู", "ุงููููุฉ", "ุฏูุดู"],
                    correct: 1
                }
            ],
            23: [ // ุงูููู 23 ูู ุฑูุถุงู
                {
                    question: "ูู ูู ุงูุฎูููุฉ ุงูุฐู ุฌูุน ุงููุฑุขู ูู ูุตุญูู ูุงุญุฏุ",
                    options: ["ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนุซูุงู ุจู ุนูุงู", "ุฃุจู ุจูุฑ ุงูุตุฏูู", "ุนูู ุจู ุฃุจู ุทุงูุจ"],
                    correct: 1
                },
                {
                    question: "ูุง ูู ูุจูุฉ ุงููุณูููู ูู ุงูุตูุงุฉุ",
                    options: ["ุงููุณุฌุฏ ุงูุฃูุตู", "ุงููุนุจุฉ", "ุงูุฌุงูุน ุงูุฃููู", "ุงููุณุฌุฏ ุงููุจูู"],
                    correct: 1
                },
                {
                    question: "ูู ูู ุงููุจู ุงูุฐู ุฃูุฑ ุจุฐุจุญ ุงุจูู ููุฏุงุกู ูู ูุตุฉู ูุดููุฑุฉุ",
                    options: ["ุฅุณุญุงู", "ุฅุณูุงุนูู", "ุงุจุฑุงููู", "ููุณู"],
                    correct: 2
                },
                {
                    question: "ูุง ุงุณู ุงููุฏููุฉ ุงูุชู ุฃุณุณูุง ุงููุจู ูุญูุฏ ุตูู ุงููู ุนููู ูุณูู ุจุนุฏ ุงููุฌุฑุฉุ",
                    options: ["ููุฉ", "ุงููุฏููุฉ ุงููููุฑุฉ", "ุงูุทุงุฆู", "ุฏูุดู"],
                    correct: 1
                },
                {
                    question: "ุฃู ูู ุงูุตุญุงุจุฉ ูุงู ูุดููุฑูุง ุจุฑูุงูุฉ ุงูุฃุญุงุฏูุซ ูููู ุนูู 'ุญุจุฑ ุงูุฃูุฉ'ุ",
                    options: ["ุฃุจู ูุฑูุฑุฉ", "ุนุจุฏ ุงููู ุจู ูุณุนูุฏ", "ุณููุงู ุงููุงุฑุณู", "ุนุจุฏุงููู ุงุจู ุนุจุงุณ"],
                    correct: 3
                }
            ],

            24: [ // ุงูููู 24 ูู ุฑูุถุงู
    {
        "question": "ูู ุชููู ูู ุขุฎุฑ ุงูุตุญุงุจุฉุ",
        "options": ["ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุฃูุณ ุจู ูุงูู", "ุนูู ุจู ุฃุจู ุทุงูุจ", "ูุนุงููุฉ ุจู ุฃุจู ุณููุงู"],
        "correct": 1
    },
    {
        "question": "ูู ุงูุตุญุงุจู ุงูุฐู ุณูุน ุงููุจู ๏ทบ ูุฑุน ูุนููู ูู ุงูุฌูุฉุ",
        "options": ["ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุฃุจู ุจูุฑ ุงูุตุฏูู", "ุณููุงู ุงููุงุฑุณู", "ุจูุงู ุจู ุฑุจุงุญ"],
        "correct": 3
    },
    {
        "question": "ูู ุฃูู ูู ุขูู ุจุงููุจู ๏ทบ ูู ุงูุจุดุฑุ",
        "options": ["ุฃุจู ุจูุฑ ุงูุตุฏูู", "ุนูุฑ ุจู ุงูุฎุทุงุจ", "ุนุงุฆุดุฉ ุจูุช ุฃุจู ุจูุฑ", "ุฎุฏูุฌุฉ ุจูุช ุฎูููุฏ"],
        "correct": 3
    },
    {
        "question": "ูู ุนุฏุฏ ุงูุบุฒูุงุช ุงูุชู ูุงุฏูุง ุงููุจู ๏ทบ ุจููุณูุ",
        "options": ["9", "17", "27", "34"],
        "correct": 2
    },
    {
        "question": "ูุง ุงุณู ุณูู ุงููุจู ๏ทบุ",
        "options": ["ุฐู ุงูููุงุฑ", "ุงูุตูุตุงู", "ุงูุญุณุงู", "ุงูุจุชุงุฑ"],
        "correct": 0
    }
],



            25: [ // ุงูููู 25 ูู ุฑูุถุงู
    {
        question: "ูู ุนุฏุฏ ุงูุณูุฑ ุงูุชู ุจุฏุฃุช ุจุงูุญุฑูู ุงูููุทุนุฉ (ูุซู: ุงูู) ุ",
        options: ["27", "29", "30", "31"],
        correct: 1
    },
    {
        question: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ูุฒูุช ูุงููุฉ ุฏูุนุฉ ูุงุญุฏุฉุ",
        options: ["ุณูุฑุฉ ุงูููุฑ", "ุณูุฑุฉ ุงูุฃูุนุงู", "ุณูุฑุฉ ุงูุชูุจุฉ", "ุณูุฑุฉ ูุฑูู"],
        correct: 1
    },
    {
        question: "ูู ูู ุงูุตุญุงุจู ุงููููุจ ุจู(ุณูุฏ ุงููุฑูุงุก) ุ",
        options: ["ุฒูุฏ ุจู ุซุงุจุช", "ุฃุจู ุจู ูุนุจ", "ุนุจุฏ ุงููู ุจู ูุณุนูุฏ", "ุณููุงู ุงููุงุฑุณู"],
        correct: 1
    },
    {
        question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ูููุจ ุจู(ุฃููู ุงูุฃูุฉ) ุ",
        options: ["ุฃุจู ุนุจูุฏุฉ ุจู ุงูุฌุฑุงุญ", "ุนุจุฏ ุงูุฑุญูู ุจู ุนูู", "ุณุนุฏ ุจู ุฃุจู ููุงุต", "ุญุฐููุฉ ุจู ุงูููุงู"],
        correct: 0
    },
    {
        question: "ูู ูู ุงูุตุญุงุจู ุงูุฐู ูุชุจ ุงููุญู ูููุจู ุตูู ุงููู ุนููู ูุณูู ููุงู ูู ูุจุงุฑ ุงููุฑูุงุกุ",
        options: ["ุฃุจู ุจู ูุนุจ", "ุฒูุฏ ุจู ุซุงุจุช", "ุนุจุฏ ุงููู ุจู ูุณุนูุฏ", "ูุนุงุฐ ุจู ุฌุจู"],
        correct: 1
    }
],


            
            
            
        };

        // ุจูู ุงูุฃุณุฆูุฉ ุงููุชุงุญ
        let questionBank = [];

        // ุญุงูุฉ ุงููุนุจุฉ
        const gameState = {
            playerName: "",
            playerEmail: "",
            deviceId: "",
            currentQuestion: 0,
            score: 0,
            answers: [],
            timeLeft: 10,
            timer: null,
            questions: [],
            questionStartTime: null,
            questionTimes: [],
            totalTime: 0,
            isAnswered: false,
            // ุฅุถุงูุฉ ูุตูููุฉ ูุชุฎุฒูู ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ ุจุนุฏ ุงูุฎูุท
            correctAnswers: []
        };

// ุงูุนูุงุตุฑ
const elements = {
    startScreen: document.getElementById('start-screen'),
    quizScreen: document.getElementById('quiz-screen'),
    resultsScreen: document.getElementById('results-screen'),
    thankYouScreen: document.getElementById('thank-you-screen'), // ุฅุถุงูุฉ ูุฐุง ุงูุณุทุฑ
    countdownScreen: document.getElementById('countdown-screen'),
    playerNameInput: document.getElementById('player-name'),
    playerEmailInput: document.getElementById('player-email'),
    startButton: document.getElementById('start-button'),
    playerWelcome: document.getElementById('player-welcome'),
    questionCounter: document.getElementById('question-counter'),
    questionText: document.getElementById('question-text'),
    optionsContainer: document.getElementById('options-container'),
    timer: document.getElementById('timer'),
    timerBar: document.getElementById('timer-bar'),
    outOfTimeScreen: document.getElementById('out-of-time-screen'),
    alreadyParticipatedScreen: document.getElementById('already-participated-screen'),
    loadingScreen: document.getElementById('loading-screen')
};

        
        // ===== ุงูุฌุฒุก ุงูุฃูู: ูุชุบูุฑุงุช ุงูุชุญูู ูุฅุนุฏุงุฏุงุช ุงููุณุงุจูุฉ =====
        
        // ูุถุน ุงููุณุงุจูุฉ: "auto" ููุชูููุช ุงูุชููุงุฆูุ "always" ูุชููู ูุชุงุญุฉ ุฏุงุฆููุงุ "never" ูุชููู ุบูุฑ ูุชุงุญุฉ ุฏุงุฆููุง
        const QUIZ_MODE = "auto"; // ููุงุฎุชุจุงุฑุ ูููู ุชุบููุฑู ุฅูู "auto" ูุงุญูุงู







        
        // ุฃููุงุช ุงููุณุงุจูุฉ (ุจุงูุณุงุนุงุช ูุงูุฏูุงุฆู - ูุธุงู 24 ุณุงุนุฉ)
        const QUIZ_START_HOUR = 19;    // 7 ูุณุงุกู
        const QUIZ_START_MINUTE = 00;  // 00 ุฏูููุฉ
        const QUIZ_END_HOUR = 20;      // 8 ูุณุงุกู
        const QUIZ_END_MINUTE = 00;    // 00 ุฏูููุฉ
        
   
        
        
        
        
        
        // ===== ุงูุฌุฒุก ุงูุซุงูู: ุงูุฏูุงู ูุงูููุทู ุงูุจุฑูุฌู =====

        /**
         * ุฅูุดุงุก ูุนุฑู ูุฑูุฏ ููุฌูุงุฒ
         * @returns {string} ูุนุฑู ุงูุฌูุงุฒ
         */
        function generateDeviceId() {
            try {
                // ุงูุชุญูู ูู ูุฌูุฏ ูุนุฑู ูุฎุฒู ูุณุจูุงู
                let deviceId = localStorage.getItem('quizDeviceId');
                
                // ุฅุฐุง ูู ููู ููุงู ูุนุฑูุ ูู ุจุฅูุดุงุก ูุงุญุฏ ุฌุฏูุฏ
                if (!deviceId) {
                    deviceId = 'device_' + Math.random().toString(36).substring(2, 15) + 
                               Math.random().toString(36).substring(2, 15);
                    localStorage.setItem('quizDeviceId', deviceId);
                }
                
                return deviceId;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุฅูุดุงุก ูุนุฑู ุงูุฌูุงุฒ:', error);
                // ุฅุฑุฌุงุน ูุนุฑู ุนุดูุงุฆู ูู ุญุงูุฉ ุงูุฎุทุฃ
                return 'device_' + Date.now();
            }
        }

        /**
         * ุฏุงูุฉ ูุฎูุท ุงููุตูููุฉ (ุฎูุงุฑุฒููุฉ Fisher-Yates)
         * @param {Array} array - ุงููุตูููุฉ ุงููุฑุงุฏ ุฎูุทูุง
         * @returns {Array} - ุงููุตูููุฉ ุจุนุฏ ุงูุฎูุท
         */
        function shuffleArray(array) {
            const newArray = [...array]; // ูุณุฎ ุงููุตูููุฉ ูุชุฌูุจ ุชุนุฏูู ุงูุฃุตู
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        /**
         * ุฏุงูุฉ ูุฎูุท ุงูุฃุณุฆูุฉ ูุงูุฎูุงุฑุงุช ูุน ุงูุงุญุชูุงุธ ุจุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
         * @param {Array} questions - ูุตูููุฉ ุงูุฃุณุฆูุฉ ุงูุฃุตููุฉ
         * @returns {Object} - ูุงุฆู ูุญุชูู ุนูู ุงูุฃุณุฆูุฉ ุงููุฎููุทุฉ ูุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
         */
        function shuffleQuestions(questions) {
            // ุฎูุท ุชุฑุชูุจ ุงูุฃุณุฆูุฉ
            const shuffledQuestions = shuffleArray([...questions]);
            const correctAnswers = [];
            
            // ููู ุณุคุงูุ ูุฎูุท ุงูุฎูุงุฑุงุช ููุญุชูุธ ุจุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
            const processedQuestions = shuffledQuestions.map(question => {
                // ูุญุถุฑ ุงูุฎูุงุฑุงุช ูุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
                const options = [...question.options];
                const correctOption = options[question.correct];
                
                // ูุฎูุท ุงูุฎูุงุฑุงุช
                const shuffledOptions = shuffleArray(options);
                
                // ูุญุฏุฏ ูููุน ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุจุนุฏ ุงูุฎูุท
                const newCorrectIndex = shuffledOptions.indexOf(correctOption);
                
                // ูุฎุฒู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุงูุฌุฏูุฏุฉ
                correctAnswers.push(newCorrectIndex);
                
                // ูุนูุฏ ุงูุณุคุงู ุจุงูุฎูุงุฑุงุช ุงููุฎููุทุฉ
                return {
                    question: question.question,
                    options: shuffledOptions,
                    correct: newCorrectIndex
                };
            });
            
            return {
                questions: processedQuestions,
                correctAnswers: correctAnswers
            };
        }

        // ุฏุงูุฉ ุงูุชุญูู ูู ููุช ุงููุณุงุจูุฉ
        function checkQuizTimeStatus() {
            // ุงูุชุญูู ูู ูุถุน ุงููุณุงุจูุฉ ุฃููุงู
            if (QUIZ_MODE === "always") {
                return {
                    isAvailable: true,
                    message: "ุงููุณุงุจูุฉ ูุชุงุญุฉ ุงูุขู! (ูุถุน ุงูุงุฎุชุจุงุฑ)",
                    status: "available"
                };
            } else if (QUIZ_MODE === "never") {
                return {
                    isAvailable: false,
                    message: "ุงููุณุงุจูุฉ ุบูุฑ ูุชุงุญุฉ (ูุถุน ุงูุงุฎุชุจุงุฑ)",
                    status: "ended"
                };
            }
            
            // ุงูุญุตูู ุนูู ุงูููุช ุงูุญุงูู
            const now = new Date();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();
            
            // ุชุญููู ุงูููุช ุงูุญุงูู ุฅูู ุฏูุงุฆู ููุฐ ููุชุตู ุงูููู ููููุงุฑูุฉ ุงูุณููุฉ
            const currentTimeInMinutes = currentHour * 60 + currentMinute;
            
            // ุชุญุฏูุฏ ุฃููุงุช ุงููุณุงุจูุฉ ุจุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ุงููุนุฑูุฉ
            const quizStartTimeInMinutes = QUIZ_START_HOUR * 60 + QUIZ_START_MINUTE;
            const quizEndTimeInMinutes = QUIZ_END_HOUR * 60 + QUIZ_END_MINUTE;
            
            if (currentTimeInMinutes >= quizStartTimeInMinutes && currentTimeInMinutes < quizEndTimeInMinutes) {
                // ุงููุณุงุจูุฉ ูุชุงุญุฉ ุงูุขู
                return {
                    isAvailable: true,
                    message: "ุงููุณุงุจูุฉ ูุชุงุญุฉ ุงูุขู!",
                    status: "available"
                };
            } else if (currentTimeInMinutes < quizStartTimeInMinutes) {
                // ุงููุณุงุจูุฉ ุณุชุจุฏุฃ ูุงุญููุง
                // ุญุณุงุจ ุงูููุช ุงููุชุจูู ุญุชู ุจุฏุก ุงููุณุงุจูุฉ
                const hoursRemaining = Math.floor((quizStartTimeInMinutes - currentTimeInMinutes) / 60);
                const minutesRemaining = (quizStartTimeInMinutes - currentTimeInMinutes) % 60;
                
                let timeMessage = "";
                if (hoursRemaining > 0) {
                    timeMessage = `${hoursRemaining} ุณุงุนุฉ ู ${minutesRemaining} ุฏูููุฉ`;
                } else {
                    timeMessage = `${minutesRemaining} ุฏูููุฉ`;
                }
                
                return {
                    isAvailable: false,
                    message: `ุงููุณุงุจูุฉ ุณุชุจุฏุฃ ุจุนุฏ ${timeMessage} (ุงูุณุงุนุฉ ${QUIZ_START_HOUR}:${QUIZ_START_MINUTE.toString().padStart(2, '0')} ูุณุงุกู)`,
                    status: "upcoming"
                };
            } else {
                // ุงููุณุงุจูุฉ ุงูุชูุช
                return {
                    isAvailable: false,
                    message: `ุงูุชูุช ุงููุณุงุจูุฉ ููููู. ุชุจุฏุฃ ุบุฏูุง ุงูุณุงุนุฉ ${QUIZ_START_HOUR}:${QUIZ_START_MINUTE.toString().padStart(2, '0')} ูุณุงุกู`,
                    status: "ended"
                };
            }
        }
        
        /**
         * ุงูุญุตูู ุนูู ุชุงุฑูุฎ ุงูููู ุจุชูุณูู ููุญุฏ (DD-MM-YYYY)
         * ุงุณุชุฎุฏุงู ูุฐุง ุงูุชูุณูู ูุชุฌูุจ ูุดุงูู ุงูููุงุทู ุงูุฒูููุฉ
         */
        function getTodayFormatted() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            return `${day}-${month}-${year}`;
        }

        /**
         * ุงูุชุญูู ูู ุฅุนุงุฏุฉ ุถุจุท ุงููุดุงุฑูุฉ ุงูููููุฉ
         * ุฅุฐุง ูุงู ุงูุชุงุฑูุฎ ุงููุฎุฒู ูุฎุชูููุง ุนู ุชุงุฑูุฎ ุงููููุ ูุชู ุฅุนุงุฏุฉ ุถุจุท ุจูุงูุงุช ุงููุดุงุฑูุฉ
         */
        function checkAndResetParticipation() {
            try {
                const today = getTodayFormatted();
                const storedDate = localStorage.getItem('participationDate');
                
                console.log("ุชุงุฑูุฎ ุงูููู:", today);
                console.log("ุชุงุฑูุฎ ุงููุดุงุฑูุฉ ุงููุฎุฒู:", storedDate);
                
                if (!storedDate || storedDate !== today) {
                    console.log("ุฅุนุงุฏุฉ ุถุจุท ุจูุงูุงุช ุงููุดุงุฑูุฉ - ููู ุฌุฏูุฏ");
                    
                    // ุญูุธ ุงููุดุงุฑูุฉ ุงูุณุงุจูุฉ ูู ุณุฌู ุงููุดุงุฑูุงุช (ุงุฎุชูุงุฑู)
                    const previousInfo = localStorage.getItem('participationInfo');
                    if (previousInfo) {
                        const history = JSON.parse(localStorage.getItem('participationHistory') || '[]');
                        history.push(JSON.parse(previousInfo));
                        localStorage.setItem('participationHistory', JSON.stringify(history));
                    }
                    
                    // ูุณุญ ุจูุงูุงุช ุงููุดุงุฑูุฉ ุงูุญุงููุฉ
                    localStorage.removeItem('participationDate');
                    localStorage.removeItem('participationInfo');
                    localStorage.removeItem('hasParticipated');
                    
                    return true; // ุชู ุฅุนุงุฏุฉ ุงูุถุจุท
                }
                
                return false; // ูู ูุชู ุฅุนุงุฏุฉ ุงูุถุจุท (ููุณ ุงูููู)
            } catch (error) {
                console.error("ุฎุทุฃ ูู ุงูุชุญูู ูู ุงูุชุงุฑูุฎ:", error);
                return false;
            }
        }

        /**
         * ุงูุชุญูู ูู ุงููุดุงุฑูุฉ ุงูููููุฉ ูุญููุงู
         * @returns {boolean} - ูู ุงููุณุชุฎุฏู ุดุงุฑู ุจุงููุนู ุงูููู
         */
        function checkLocalParticipation() {
            try {
                // ุฅุนุงุฏุฉ ุถุจุท ุงููุดุงุฑูุฉ ุฅุฐุง ูุงู ููู ุฌุฏูุฏ
                checkAndResetParticipation();
                
                // ุงูุชุญูู ูู ุญุงูุฉ ุงููุดุงุฑูุฉ ุจุนุฏ ุฅุนุงุฏุฉ ุงูุถุจุท ุงููุญุชููุฉ
                const today = getTodayFormatted();
                const participationDate = localStorage.getItem('participationDate');
                
                // ุงููุณุชุฎุฏู ุดุงุฑู ุงูููู ุฅุฐุง ูุงู ุงูุชุงุฑูุฎ ุงููุฎุฒู ูุณุงูู ุชุงุฑูุฎ ุงูููู
                return participationDate === today;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุงูุชุญูู ูู ุงููุดุงุฑูุฉ:', error);
                // ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃุ ูุณูุญ ุจุงููุดุงุฑูุฉ
                return false;
            }
        }

        /**
         * ุชุณุฌูู ูุดุงุฑูุฉ ุฌุฏูุฏุฉ ูุญููุงู
         * @param {string} playerName - ุงุณู ุงููุดุงุฑู
         * @param {string} playerEmail - ุจุฑูุฏ ุงููุดุงุฑู
         */
        function recordLocalParticipation(playerName, playerEmail) {
            try {
                const today = getTodayFormatted();
                
                // ุชุฎุฒูู ุชุงุฑูุฎ ุงููุดุงุฑูุฉ
                localStorage.setItem('participationDate', today);
                
                // ุชุฎุฒูู ูุนูููุงุช ุฅุถุงููุฉ ูููุดุงุฑูุฉ
                const participationInfo = {
                    date: today,
                    timestamp: new Date().toISOString(),
                    playerName: playerName,
                    playerEmail: playerEmail || ''
                };
                
                localStorage.setItem('participationInfo', JSON.stringify(participationInfo));
                localStorage.setItem('hasParticipated', 'true');
                
                console.log('ุชู ุชุณุฌูู ุงููุดุงุฑูุฉ ูุญููุงู ุจูุฌุงุญ:', today);
                return true;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงููุดุงุฑูุฉ ูุญููุงู:', error);
                return false;
            }
        }

        /**
         * ุงูุชุญูู ูู ุงููุดุงุฑูุฉ ูู Firestore
         * @param {string} deviceId - ูุนุฑู ุงูุฌูุงุฒ
         * @returns {Promise<boolean>} - ูุนุฏ ูุญู ุฅูู ูููุฉ ููุทููุฉ ุชุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฏ ุดุงุฑู ุจุงููุนู
         */
        async function checkFirestoreParticipation(deviceId) {
            try {
                const today = getTodayFormatted();
                
                // ุงูุจุญุซ ุนู ูุดุงุฑูุฉ ุงูููู ููุฐุง ุงูุฌูุงุฒ
                const participationQuery = await db.collection('participants')
                    .where('deviceId', '==', deviceId)
                    .where('participationDate', '==', today)
                    .limit(1)
                    .get();
                
                // ุฅุฐุง ูุงูุช ููุงู ูุซููุฉ ูุงุญุฏุฉ ุนูู ุงูุฃููุ ููุฐุง ูุนูู ุฃู ุงููุณุชุฎุฏู ุดุงุฑู ุจุงููุนู
                return !participationQuery.empty;
            } catch (error) {
                                console.error('ุฎุทุฃ ูู ุงูุชุญูู ูู ุงููุดุงุฑูุฉ ูู Firestore:', error);
                // ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃุ ูุนุชูุฏ ุนูู ุงูุชุฎุฒูู ุงููุญูู
                return checkLocalParticipation();
            }
        }

        /**
         * ุชุณุฌูู ูุดุงุฑูุฉ ุฌุฏูุฏุฉ ูู Firestore
         * @param {Object} participationData - ุจูุงูุงุช ุงููุดุงุฑูุฉ
         * @returns {Promise<boolean>} - ูุนุฏ ูุญู ุฅูู ูููุฉ ููุทููุฉ ุชุดูุฑ ุฅูู ูุฌุงุญ ุงูุนูููุฉ
         */
        async function recordFirestoreParticipation(participationData) {
            try {
                // ุฅุถุงูุฉ ูุซููุฉ ุฌุฏูุฏุฉ ุฅูู ูุฌููุนุฉ ุงููุดุงุฑููู
                await db.collection('participants').add({
                    ...participationData,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                console.log('ุชู ุชุณุฌูู ุงููุดุงุฑูุฉ ูู Firestore ุจูุฌุงุญ');
                return true;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงููุดุงุฑูุฉ ูู Firestore:', error);
                return false;
            }
        }

        // ุชุญุฏูุซ ุฑุณุงูุฉ ุงูููุช
        function updateTimeMessage() {
            const quizTimeStatus = checkQuizTimeStatus();
            document.getElementById('time-message').textContent = quizTimeStatus.message;
        }

        // ุชุญุฏูุซ ุงูุชุงุฑูุฎ ูุงูููุช
        function updateDateTime() {
            const days = ['ุงูุฃุญุฏ', 'ุงูุฅุซููู', 'ุงูุซูุงุซุงุก', 'ุงูุฃุฑุจุนุงุก', 'ุงูุฎููุณ', 'ุงูุฌูุนุฉ', 'ุงูุณุจุช'];
            const now = new Date();
            const dayName = days[now.getDay()];
            const date = now.toLocaleDateString('ar-SA');
            
            document.getElementById('day-name').textContent = dayName;
            document.getElementById('current-date').textContent = date;
        }

        // ุจุฏุก ุงูุนุฏ ุงูุชูุงุฒูู
        function startCountdown() {
            const countdownMessages = [
                { number: 5, text: "ุงุณุชุนุฏ ุงูุชุญุฏู ุณูุจุฏุฃ! ๐ฅ" },
                { number: 4, text: "ุฑููุฒุ ุงููุฑุตุฉ ุฃูุงูู! ๐" },
                { number: 3, text: "ูุญุธุงุช ููุญุณูุ ูุง ุชุชุฑุฏุฏ! โก๏ธ" },
                { number: 2, text: "ูู ุงูุฃุณุฑุนุ ูู ุงูุฃุฐูู! ๐" },
                { number: 1, text: "ุงูุขูโฆ ุฃุทูู ุฅุจุฏุงุนู! ๐ฏ" }
            ];

            let currentIndex = 0;
            elements.countdownScreen.classList.remove('hidden');
            
            function updateCountdown() {
                if (currentIndex >= countdownMessages.length) {
                    elements.countdownScreen.classList.add('hidden');
                    showQuestion();
                    return;
                }

                const message = countdownMessages[currentIndex];
                document.getElementById('countdown-number').textContent = message.number;
                document.getElementById('countdown-text').textContent = message.text;

                currentIndex++;
                setTimeout(updateCountdown, 1000);
            }

            updateCountdown();
        }

        // ุนุฑุถ ุงูุณุคุงู
        function showQuestion() {
            elements.quizScreen.classList.remove('hidden');
            gameState.isAnswered = false;
            
            const question = gameState.questions[gameState.currentQuestion];
            elements.questionCounter.textContent = `ุงูุณุคุงู ${gameState.currentQuestion + 1} ูู ${gameState.questions.length}`;
            elements.questionText.textContent = question.question;
            
            elements.optionsContainer.innerHTML = question.options.map((option, index) => `
                <button
                    onclick="handleAnswer(${index})"
                    class="w-full text-right bg-white/5 hover:bg-white/10 border-2 border-green-400/20 p-4 rounded-xl transition-colors"
                >
                    ${option}
                </button>
            `).join('');

            gameState.questionStartTime = Date.now();
            startTimer();
            lucide.createIcons();
        }

        // ูุนุงูุฌุฉ ุงูุฅุฌุงุจุฉ - ุงููุณุฎุฉ ุงููุตุญุญุฉ
        function handleAnswer(selectedOption) {
            // ุงูุชุญูู ูู ุฃู ุงูุณุคุงู ูู ุชุชู ุงูุฅุฌุงุจุฉ ุนููู ุจุงููุนู
            if (gameState.isAnswered) return;
            gameState.isAnswered = true;
            
            // ุฅููุงู ุงููุคูุช
            clearInterval(gameState.timer);
            
            // ุญุณุงุจ ููุช ุงูุฅุฌุงุจุฉ
            const answerTime = (Date.now() - gameState.questionStartTime) / 1000;
            gameState.questionTimes.push(answerTime);
            
            const question = gameState.questions[gameState.currentQuestion];
            
            // ุงูุชุนุงูู ูุน ุญุงูุฉ ุงูุชูุงุก ุงูููุช (selectedOption = -1)
            const isCorrect = selectedOption >= 0 && selectedOption === question.correct;
            
            // ุญุณุงุจ ุงูููุงุท ุจูุงุกู ุนูู ุณุฑุนุฉ ุงูุฅุฌุงุจุฉ
            let points = 0;
            if (isCorrect) {
                if (answerTime <= 3) points = 100;
                else if (answerTime <= 5) points = 80;
                else if (answerTime <= 7) points = 60;
                else points = 40;
            }
            
            // ุฅุถุงูุฉ ุงูููุงุท ูุงูููุช ุฅูู ุงููุฌููุน
            gameState.score += points;
            gameState.totalTime += answerTime;

            // ุชุนุทูู ุฌููุน ุงูุฎูุงุฑุงุช
            const options = elements.optionsContainer.children;
            Array.from(options).forEach(option => {
                option.classList.add('option-disabled');
            });
            
            // ุฅุถุงูุฉ ุงูุชุฃุซูุฑุงุช ุงูุจุตุฑูุฉ ููุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูุงูุฎุงุทุฆุฉ
            if (selectedOption >= 0) {
                options[selectedOption].classList.add(isCorrect ? 'option-correct' : 'option-wrong');
            }
            
            // ุฅุธูุงุฑ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุฏุงุฆูุงู
            if (!isCorrect) {
                options[question.correct].classList.add('option-correct');
            }

            // ุชุฎุฒูู ูุนูููุงุช ุงูุฅุฌุงุจุฉ
            gameState.answers.push({
                question: question.question,
                selectedAnswer: selectedOption >= 0 ? question.options[selectedOption] : "ูู ูุชู ุงูุฅุฌุงุจุฉ",
                correctAnswer: question.options[question.correct],
                isCorrect: isCorrect,
                time: answerTime,
                points: points
            });

            // ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุชุงูู ุฃู ุฅุธูุงุฑ ุงููุชุงุฆุฌ ุจุนุฏ ูุชุฑุฉ ูุตูุฑุฉ
            setTimeout(() => {
                if (gameState.currentQuestion < gameState.questions.length - 1) {
                    gameState.currentQuestion++;
                    showQuestion();
                } else {
                    showResults();
                }
            }, 1500);
        }

        // ุจุฏุก ุงููุคูุช
        function startTimer() {
            gameState.timeLeft = 10;
            elements.timer.textContent = gameState.timeLeft;
            elements.timerBar.style.width = '100%';
            
            clearInterval(gameState.timer);
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                elements.timer.textContent = gameState.timeLeft;
                elements.timerBar.style.width = `${(gameState.timeLeft / 10) * 100}%`;
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    handleTimeUp();
                }
            }, 1000);
        }

        // ูุนุงูุฌุฉ ุงูุชูุงุก ุงูููุช
        function handleTimeUp() {
            if (gameState.isAnswered) return;
            handleAnswer(-1);
        }

        // ุนุฑุถ ุงููุชุงุฆุฌ




        // ุนุฑุถ ุงููุชุงุฆุฌ
async function showResults() {
    try {
        // ุฅุฎูุงุก ุดุงุดุฉ ุงูุฃุณุฆูุฉ
        elements.quizScreen.classList.add('hidden');
        
        // ุฅุธูุงุฑ ุดุงุดุฉ ุงูุดูุฑ
        elements.thankYouScreen.classList.remove('hidden');
        
        // ุชุญุถูุฑ ุจูุงูุงุช ุงููุชุงุฆุฌ
        const playerData = {
            playerName: gameState.playerName,
            playerEmail: gameState.playerEmail || '',
            deviceId: gameState.deviceId,
            score: gameState.score,
            totalTime: gameState.totalTime,
            participationDate: getTodayFormatted(),
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        // ุญูุธ ุงููุชุงุฆุฌ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        await db.collection('scores').add(playerData);

        // ุฅุถุงูุฉ ูุณุชูุน ุญุฏุซ ูุฒุฑ ุนุฑุถ ุงููุชุงุฆุฌ
        document.getElementById('show-results-button').addEventListener('click', () => {
            // ุฅุฎูุงุก ุดุงุดุฉ ุงูุดูุฑ
            elements.thankYouScreen.classList.add('hidden');
            
            // ุฅุธูุงุฑ ุดุงุดุฉ ุงููุชุงุฆุฌ
            elements.resultsScreen.classList.remove('hidden');
            
            // ุชุญุฏูุซ ูุญุชูู ุงููุชุงุฆุฌ
            document.getElementById('final-name').textContent = `ุงูุงุณู: ${gameState.playerName}`;
            document.getElementById('final-score').innerHTML = `
                ุงูููุงุท: ${gameState.score}<br>
                ุงูููุช ุงูุฅุฌูุงูู: ${gameState.totalTime.toFixed(2)} ุซุงููุฉ
            `;

            // ุนุฑุถ ูุฑุงุฌุนุฉ ุงูุฅุฌุงุจุงุช
            const answersHtml = gameState.answers.map((answer, index) => `
                <div class="bg-white/5 p-4 rounded-xl">
                    <div class="font-bold mb-2">ุงูุณุคุงู ${index + 1}</div>
                    <div class="text-sm opacity-90 mb-2">${answer.question}</div>
                    <div class="text-sm ${answer.isCorrect ? 'text-green-400' : 'text-red-400'}">
                        ุฅุฌุงุจุชู: ${answer.selectedAnswer}
                        ${!answer.isCorrect ? `<br>ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ: ${answer.correctAnswer}` : ''}
                    </div>
                    <div class="text-sm mt-2">
                        ุงูููุช: ${answer.time.toFixed(2)} ุซุงููุฉ
                        <br>
                        ุงูููุงุท: ${answer.points}
                    </div>
                </div>
            `).join('');

            document.getElementById('answers-review').innerHTML = answersHtml;
            lucide.createIcons();
        });

    } catch (error) {
        console.error('Error saving results:', error);
        alert('ุญุฏุซ ุฎุทุฃ ูู ุญูุธ ุงููุชูุฌุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
    }
}

        

        // ุชููุฆุฉ ุงููุณุงุจูุฉ
        async function initializeQuiz() {
            try {
                // ุชููุฆุฉ ูุนุฑู ุงูุฌูุงุฒ
                gameState.deviceId = generateDeviceId();
                console.log('ูุนุฑู ุงูุฌูุงุฒ:', gameState.deviceId);
                
                updateDateTime();
                
                // ุฅุธูุงุฑ ุดุงุดุฉ ุงูุชุญููู
                elements.loadingScreen.classList.remove('hidden');
                
                // ุงูุชุญูู ูู ุฅุนุงุฏุฉ ุถุจุท ุงููุดุงุฑูุฉ ุงูููููุฉ
                checkAndResetParticipation();
                
                // ุงูุชุญูู ูู ููุช ุงููุณุงุจูุฉ
                const quizTimeStatus = checkQuizTimeStatus();
                
                if (quizTimeStatus.isAvailable) {
                    // ุงููุณุงุจูุฉ ูุชุงุญุฉ ุญุงููุงู
                    
                    // ุงูุชุญูู ูู ุงููุดุงุฑูุฉ ุงูุณุงุจูุฉ ูู Firestore
                    const hasParticipated = await checkFirestoreParticipation(gameState.deviceId);
                    
                    // ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู
                    elements.loadingScreen.classList.add('hidden');
                    
                    if (hasParticipated) {
                        // ุงููุณุชุฎุฏู ุดุงุฑู ุจุงููุนู ุงูููู
                        elements.alreadyParticipatedScreen.classList.remove('hidden');
                    } else {
                        // ุงููุณุชุฎุฏู ูู ูุดุงุฑู ุจุนุฏ
                        elements.startScreen.classList.remove('hidden');
                    }
                } else {
                    // ุงููุณุงุจูุฉ ุบูุฑ ูุชุงุญุฉ ุญุงููุงู
                    elements.loadingScreen.classList.add('hidden');
                    elements.outOfTimeScreen.classList.remove('hidden');
                    updateTimeMessage();
                }
                
                // ุชุญุฏูุซ ุฑุณุงูุฉ ุงูููุช ูู ุฏูููุฉ
                setInterval(updateTimeMessage, 60000);
            } catch (error) {
                console.error('Error initializing quiz:', error);
                // ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู ูู ุญุงูุฉ ุงูุฎุทุฃ
                elements.loadingScreen.classList.add('hidden');
                alert('ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงููุณุงุจูุฉ. ูุฑุฌู ุชุญุฏูุซ ุงูุตูุญุฉ.');
            }
        }

        // ุจุฏุก ุงููุณุงุจูุฉ
        async function startQuiz() {
            try {
                // ุฅุธูุงุฑ ุดุงุดุฉ ุงูุชุญููู
                elements.startScreen.classList.add('hidden');
                elements.loadingScreen.classList.remove('hidden');
                
                // ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุงุนุจ
                gameState.playerName = elements.playerNameInput.value.trim();
                gameState.playerEmail = elements.playerEmailInput.value.trim();
                
                // ุงูุชุญูู ูู ุงููุดุงุฑูุฉ ุงูุณุงุจูุฉ ูู Firestore
                const hasParticipated = await checkFirestoreParticipation(gameState.deviceId);
                
                if (hasParticipated) {
                    // ุงููุณุชุฎุฏู ุดุงุฑู ุจุงููุนู ุงูููู
                    elements.loadingScreen.classList.add('hidden');
                    elements.alreadyParticipatedScreen.classList.remove('hidden');
                    return;
                }
                
                // ุชุณุฌูู ุงููุดุงุฑูุฉ ูุญููุงู
                recordLocalParticipation(gameState.playerName, gameState.playerEmail);
                
                // ุชุณุฌูู ุงููุดุงุฑูุฉ ูู Firestore
                const participationData = {
                    playerName: gameState.playerName,
                    playerEmail: gameState.playerEmail || '',
                    deviceId: gameState.deviceId,
                    participationDate: getTodayFormatted()
                };
                
                await recordFirestoreParticipation(participationData);
                // ุชุญุฏูุฏ ุงูููู ุงูุญุงูู
const today = new Date();
const ramadanStartDate = new Date(2026, 1, 23); // 23 ูุจุฑุงูุฑ 2026 (6 ุฑูุถุงู)
const ramadanEndDate = new Date(2026, 2, 9); // 9 ูุงุฑุณ 2026 (20 ุฑูุถุงู)

let questionDay;

if (today >= ramadanStartDate && today <= ramadanEndDate) {
    // ุญุณุงุจ ุงููุฑู ุจุงูุฃูุงู ุจูู ุงูููู ุงูุญุงูู ูุชุงุฑูุฎ ุจุฏุก ุฑูุถุงู
    const daysDifference = Math.floor((today - ramadanStartDate) / (1000 * 60 * 60 * 24));
    questionDay = daysDifference + 6; // ุงูููู ูู ุฑูุถุงู ูุจุฏุฃ ูู 6
} else {
    console.error("ุงูููู ุฎุงุฑุฌ ูุทุงู ุงููุณุงุจูุฉ.");
    alert('ุนุฐุฑุงูุ ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูููู.');
    return; // ุฅููุงุก ุงูุฏุงูุฉ ุฅุฐุง ูุงู ุงูููู ุฎุงุฑุฌ ุงููุทุงู
}

// ุงูุชุญูู ูู ูุฌูุฏ ุฃุณุฆูุฉ ููููู ุงููุญุฏุฏ
if (!ramadanQuestions[questionDay]) {
    console.error(`ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ููููู ${questionDay}`);
    alert('ุนุฐุฑุงูุ ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูููู.');
    return;
}

                
                // ุชุญุฏูุซ ุจูู ุงูุฃุณุฆูุฉ ุจุงุณุชุฎุฏุงู ุฃุณุฆูุฉ ุงูููู ุงููุญุฏุฏ ูุงูููุงู ุจุฎูุท ุงูุฃุณุฆูุฉ ูุงูุฎูุงุฑุงุช
                const originalQuestions = [...ramadanQuestions[questionDay]];
                const shuffledData = shuffleQuestions(originalQuestions);
                
                // ุชุญุฏูุซ ุญุงูุฉ ุงููุนุจุฉ ุจุงูุฃุณุฆูุฉ ุงููุฎููุทุฉ
                gameState.questions = shuffledData.questions;
                gameState.correctAnswers = shuffledData.correctAnswers;
                
                console.log('ุชู ุฎูุท ุงูุฃุณุฆูุฉ ูุงูุฎูุงุฑุงุช ุจูุฌุงุญ');
                
                // ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู
                elements.loadingScreen.classList.add('hidden');
                elements.playerWelcome.textContent = `ูุฑุญุจุงู ${gameState.playerName}!`;
                
                startCountdown();
            } catch (error) {
                console.error('Error starting quiz:', error);
                elements.loadingScreen.classList.add('hidden');
                alert('ุญุฏุซ ุฎุทุฃ ูู ุจุฏุก ุงููุณุงุจูุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
            }
        }

        // ุงูุชุญูู ูู ุตุญุฉ ุงุณู ุงููุงุนุจ
        function validatePlayerName() {
            const playerName = elements.playerNameInput.value.trim();
            if (playerName.length >= 3) {
                elements.startButton.disabled = false;
                elements.startButton.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                elements.startButton.disabled = true;
                elements.startButton.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ
        document.addEventListener('DOMContentLoaded', () => {
            try {
                lucide.createIcons();
                
                elements.playerNameInput.addEventListener('input', validatePlayerName);
                elements.startButton.addEventListener('click', startQuiz);
                
                initializeQuiz();
            } catch (error) {
                console.error('Error setting up event listeners:', error);
            }
        });

        // ุชุนุฑูู ุฏุงูุฉ handleAnswer ูู ุงููุทุงู ุงูุนุงู
        window.handleAnswer = handleAnswer;
    </script>
</body>
</html>
