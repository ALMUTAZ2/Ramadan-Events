<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† - ÙÙˆØ§Ø²ÙŠØ± Ø±Ù…Ø¶Ø§Ù†</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
*{font-family:'Cairo',sans-serif}

.trophy-1{color:#FFD700}
.trophy-2{color:#C0C0C0}
.trophy-3{color:#CD7F32}
</style>
</head>

<body class="bg-gradient-to-b from-blue-900 to-indigo-950 min-h-screen">

<div class="bg-white/5 border-b border-white/10 p-3 text-white">
<div class="max-w-3xl mx-auto flex justify-between">
<span id="day-name" class="text-blue-400"></span>
<span id="current-date" class="text-green-400"></span>
</div>
</div>

<div id="results-screen" class="p-6">
<div class="max-w-4xl mx-auto">

<!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† -->
<div id="participants-count" class="text-center text-blue-300 font-bold mb-4"></div>

<!-- ØªØ§Ø¬ Ø§Ù„Ø£Ø³Ø±Ø¹ -->
<div id="fastest-player" class="text-center text-orange-400 font-bold mb-6"></div>

<div class="text-center mb-8">
<h1 class="text-3xl font-bold text-yellow-400 mb-2">Ù†ØªØ§Ø¦Ø¬ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙŠÙˆÙ…</h1>
<p class="text-green-100" id="results-date"></p>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">

<div class="bg-white/10 border-2 border-silver/30 rounded-2xl p-6 text-center">
<i data-lucide="trophy" class="w-12 h-12 mx-auto trophy-2"></i>
<div class="font-bold">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
<div id="second-place"></div>
</div>

<div class="bg-white/10 border-2 border-yellow-400/30 rounded-2xl p-8 text-center scale-105">
<i data-lucide="trophy" class="w-16 h-16 mx-auto trophy-1"></i>
<div class="font-bold text-yellow-400 text-lg">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„</div>
<div id="first-place"></div>
</div>

<div class="bg-white/10 border-2 border-bronze/30 rounded-2xl p-6 text-center">
<i data-lucide="trophy" class="w-12 h-12 mx-auto trophy-3"></i>
<div class="font-bold">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø«</div>
<div id="third-place"></div>
</div>

</div>

<div class="bg-white/10 border-2 border-green-400/20 rounded-2xl p-6">
<h3 class="text-xl font-bold text-green-400 mb-4">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
<table class="w-full text-white">
<thead>
<tr class="border-b border-green-400/20">
<th class="p-3">Ø§Ù„Ù…Ø±ÙƒØ²</th>
<th class="p-3">Ø§Ù„Ø§Ø³Ù…</th>
<th class="p-3">Ø§Ù„Ù†Ù‚Ø§Ø·</th>
<th class="p-3">Ø§Ù„ÙˆÙ‚Øª</th>
</tr>
</thead>
<tbody id="results-table"></tbody>
</table>
</div>

</div>
</div>

<script>
const firebaseConfig={
apiKey:"AIzaSyC5RYK1lGaJaMQJmOH85cqNgv6m7rbLS_A",
authDomain:"ramadanmotaz-5570f.firebaseapp.com",
projectId:"ramadanmotaz-5570f"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

function updateDateTime(){
const days=['Ø§Ù„Ø£Ø­Ø¯','Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†','Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡','Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡','Ø§Ù„Ø®Ù…ÙŠØ³','Ø§Ù„Ø¬Ù…Ø¹Ø©','Ø§Ù„Ø³Ø¨Øª'];
const now=new Date();
document.getElementById('day-name').textContent=days[now.getDay()];
document.getElementById('current-date').textContent=now.toLocaleDateString('ar-SA');
}

function getTodayFormatted(){
const n=new Date();
return `${String(n.getDate()).padStart(2,'0')}-${String(n.getMonth()+1).padStart(2,'0')}-${n.getFullYear()}`;
}

async function fetchResults(){
const todayKey=getTodayFormatted();

const snapshot=await db.collection('scores')
.where('participationDate','==',todayKey)
.orderBy('score','desc')
.orderBy('totalTime','asc')
.get();

const results=[];
snapshot.forEach(doc=>results.push(doc.data()));

if(results.length===0)return;

// âœ… Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†
document.getElementById('participants-count').textContent=
`Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„ÙŠÙˆÙ…: ${results.length}`;

const top3=results.slice(0,3);

document.getElementById('first-place').innerHTML=
`<div>${top3[0].playerName}</div><div>${top3[0].score} Ù†Ù‚Ø·Ø©</div><div>${Number(top3[0].totalTime).toFixed(2)} Ø«</div>`;

if(top3[1])
document.getElementById('second-place').innerHTML=
`<div>${top3[1].playerName}</div><div>${top3[1].score} Ù†Ù‚Ø·Ø©</div><div>${Number(top3[1].totalTime).toFixed(2)} Ø«</div>`;

if(top3[2])
document.getElementById('third-place').innerHTML=
`<div>${top3[2].playerName}</div><div>${top3[2].score} Ù†Ù‚Ø·Ø©</div><div>${Number(top3[2].totalTime).toFixed(2)} Ø«</div>`;

// ğŸ”¥ Ø§Ù„Ø£Ø³Ø±Ø¹ Ø¶Ù…Ù† Ø£ÙˆÙ„ 3
let fastest=top3.reduce((a,b)=>Number(a.totalTime)<Number(b.totalTime)?a:b);

let badge=`ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ÙŠÙˆÙ…: ${fastest.playerName}`;
if(fastest.playerName===top3[0].playerName)
badge=`ğŸ†ğŸ”¥ ${fastest.playerName} Ø¬Ù…Ø¹ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„ ÙˆØ£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø©`;

document.getElementById('fastest-player').textContent=badge;

// Ø¬Ø¯ÙˆÙ„ ÙƒØ§Ù…Ù„
document.getElementById('results-table').innerHTML=
results.map((r,i)=>`
<tr class="border-b border-white/10">
<td class="p-3">${i+1}</td>
<td class="p-3">${r.playerName}</td>
<td class="p-3">${r.score}</td>
<td class="p-3">${Number(r.totalTime).toFixed(2)} Ø«</td>
</tr>`).join('');

document.getElementById('results-date').textContent=
`Ù†ØªØ§Ø¦Ø¬ ${new Date().toLocaleDateString('ar-SA')}`;
}

document.addEventListener('DOMContentLoaded',()=>{
updateDateTime();
fetchResults();
lucide.createIcons();
});
</script>
</body>
</html> 
