<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† - ÙÙˆØ§Ø²ÙŠØ± Ø±Ù…Ø¶Ø§Ù†</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
*{font-family:'Cairo',sans-serif}

/* âœ¨ ØªØ£Ø«ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„ÙØ§Ø¦Ø² */
@keyframes glowPulse{
0%{box-shadow:0 0 10px rgba(255,215,0,.3)}
50%{box-shadow:0 0 25px rgba(255,215,0,.8)}
100%{box-shadow:0 0 10px rgba(255,215,0,.3)}
}

.winner-effect{
animation:glowPulse 2s infinite;
transform:scale(1.03);
}
</style>
</head>

<body class="bg-gradient-to-b from-blue-900 to-indigo-950 min-h-screen text-white">

<div class="p-6 max-w-4xl mx-auto">

<div class="grid md:grid-cols-3 gap-4 mb-8">

<!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„ -->
<div id="first-card" class="bg-[#3d5191] border border-yellow-400 rounded-2xl p-8 text-center transition">
<i data-lucide="trophy" class="w-16 h-16 mx-auto text-yellow-400"></i>
<div class="text-yellow-400 font-bold text-lg mt-2">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„</div>
<div id="first-place"></div>
</div>

<!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ -->
<div id="second-card" class="bg-[#3d5191] border border-gray-300 rounded-2xl p-6 text-center">
<i data-lucide="trophy" class="w-12 h-12 mx-auto text-gray-300"></i>
<div class="font-bold mt-2">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
<div id="second-place"></div>
</div>

<!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø« -->
<div id="third-card" class="bg-[#3d5191] border border-orange-400 rounded-2xl p-6 text-center">
<i data-lucide="trophy" class="w-12 h-12 mx-auto text-orange-400"></i>
<div class="font-bold mt-2">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø«</div>
<div id="third-place"></div>
</div>

</div>

<div class="bg-white/10 rounded-2xl p-6">
<h3 class="text-green-400 font-bold mb-4">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
<table class="w-full text-white">
<thead>
<tr class="border-b border-green-400/20">
<th class="p-3">Ø§Ù„Ù…Ø±ÙƒØ²</th>
<th class="p-3">Ø§Ù„Ø§Ø³Ù…</th>
<th class="p-3">Ø§Ù„Ù†Ù‚Ø§Ø·</th>
<th class="p-3">Ø§Ù„ÙˆÙ‚Øª</th>
</tr>
</thead>
<tbody id="results-table"></tbody>
</table>
</div>

</div>

<script>
const firebaseConfig={
apiKey:"AIzaSyC5RYK1lGaJaMQJmOH85cqNgv6m7rbLS_A",
authDomain:"ramadanmotaz-5570f.firebaseapp.com",
projectId:"ramadanmotaz-5570f"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

function getToday(){
const n=new Date();
return `${String(n.getDate()).padStart(2,'0')}-${String(n.getMonth()+1).padStart(2,'0')}-${n.getFullYear()}`;
}

async function fetchResults(){

const today=getToday();

const snap=await db.collection('scores')
.where('participationDate','==',today)
.orderBy('score','desc')
.orderBy('totalTime','asc')
.get();

const results=[];
snap.forEach(d=>results.push(d.data()));
if(results.length===0)return;

const top3=results.slice(0,3);

// Ø£Ø³Ø±Ø¹ Ø¶Ù…Ù† Ø§Ù„Ø«Ù„Ø§Ø«Ø©
const fastest=top3.reduce((a,b)=>Number(a.totalTime)<Number(b.totalTime)?a:b);

// ğŸ† Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„
const first=top3[0];

document.getElementById('first-place').innerHTML=
`<div class="font-bold">${first.playerName}</div>
<div class="text-yellow-400">${first.score} Ù†Ù‚Ø·Ø©</div>
<div class="opacity-70">${Number(first.totalTime).toFixed(2)} Ø«Ø§Ù†ÙŠØ©</div>
${fastest.playerName===first.playerName?'<div class="text-yellow-300 text-sm mt-1">ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø©</div>':''}`;

// ØªØ£Ø«ÙŠØ± Ø¥Ø°Ø§ Ø¬Ù…Ø¹ Ø§Ù„Ù„Ù‚Ø¨ÙŠÙ†
if(fastest.playerName===first.playerName){
document.getElementById('first-card').classList.add('winner-effect');
}

// Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ
if(top3[1]){
const s=top3[1];
document.getElementById('second-place').innerHTML=
`<div class="font-bold">${s.playerName}</div>
<div>${s.score} Ù†Ù‚Ø·Ø©</div>
<div class="opacity-70">${Number(s.totalTime).toFixed(2)} Ø«Ø§Ù†ÙŠØ©</div>
${fastest.playerName===s.playerName?'<div class="text-yellow-300 text-sm mt-1">ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø©</div>':''}`;
}

// Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø«
if(top3[2]){
const t=top3[2];
document.getElementById('third-place').innerHTML=
`<div class="font-bold">${t.playerName}</div>
<div>${t.score} Ù†Ù‚Ø·Ø©</div>
<div class="opacity-70">${Number(t.totalTime).toFixed(2)} Ø«Ø§Ù†ÙŠØ©</div>
${fastest.playerName===t.playerName?'<div class="text-yellow-300 text-sm mt-1">ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø©</div>':''}`;
}

// Ø§Ù„Ø¬Ø¯ÙˆÙ„
document.getElementById('results-table').innerHTML=
results.map((r,i)=>`
<tr class="border-b border-white/10">
<td class="p-3">${i+1}</td>
<td class="p-3">${r.playerName}</td>
<td class="p-3">${r.score}</td>
<td class="p-3">${Number(r.totalTime).toFixed(2)} Ø«Ø§Ù†ÙŠØ©</td>
</tr>`).join('');
}

fetchResults();
lucide.createIcons();
</script>

</body>
</html>
